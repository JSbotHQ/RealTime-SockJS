<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <title>Sock chat</title>
</head>
<body>
<textarea id="chat-content" style="width:500px;height:300px"></textarea><br/>
<input type="text" id="username" placeholder="Choose username"/>
<input type="text" id="message" placeholder="Enter chat message"/>
<input type="button" value="Send" onclick="sendMessage()"/>

<script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/sockjs/0.3.4/sockjs.min.js"></script>
<script >
    // Create a connection to http://localhost:9999/echo
    var sock = new SockJS('http://localhost:9999/echo');

    // Open the connection
    sock.onopen = function() {
        console.log('open');
    };

    // On connection close
    sock.onclose = function() {
        console.log('close');
    };

    sock.onmessage = function(e) {
        // Get the content
        var content = JSON.parse(e.data);

        // Append the text to text area (using jQuery)
        $('#chat-content').val(function(i, text){
            return text + 'User ' + content.username + ': ' + content.message + '\n';
        });

    };

    function sendMessage(){
        // Get the content from the textbox
        var message = $('#message').val();
        var username = $('#username').val();

        // The object to send
        var send = {
            message: message,
            username: username
        };

        // Send it now
        sock.send(JSON.stringify(send));
    }
</script>
</body>
</html>